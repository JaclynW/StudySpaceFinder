<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="assets/icon.png" type="image/png">
    <link rel="stylesheet" href="css/adminDashboard.css">
    <link rel="stylesheet" href="css/style.css">
    <title>Admin Dashboard</title>
</head>

<body>

    <nav id="navbar">
        <div id="logo"><a href="index.html">Study Spot Finder</a></div>
        <form id="search-form">
            <div id="search-box">
                <input type="search" id="search-input" placeholder="Enter zipcode..." pattern="^\d{5}$"
                    title="Enter a 5-digit ZIP code.">
                <button id="search-btn">&#128269;</button>
                <button type="button" id="close-btn">&#10006;</button>
            </div>
            <div id="error-message" style="color: red; display: none;">Please enter a valid ZIP code.</div>
        </form>

    </nav>
    <header>
        <h1>Admin Dashboard</h1>
    </header>

    <section id="pendingApprovals">
        <h2>Pending Spot Approvals</h2>
        <ul id="pendingList">
            <!-- Pending spots will be dynamically loaded here -->
            <li>
                <p>Spot Name: Quiet Study Cafe</p>
                <p>Location: Downtown</p>
                <!-- More spot details here -->
                <button onclick="editSpot()">Edit</button>
                <button class="approveBtn" data-spot-id="1">Approve</button>
            </li>
            <!-- Repeat for each pending spot -->
        </ul>
    </section>

    <!-- Edit Spot Modal -->
    <div id="editModal"
        style="display:none; position:fixed; z-index:1; left:0; top:0; width:100%; height:100%; overflow:auto; background-color:rgba(0,0,0,0.4); padding-top:60px;">
        <div
            style="background-color:#fefefe; margin:auto; padding:20px; border:1px solid #888; width:80%; max-width:600px;">
            <h2>Edit Study Spot</h2>
            <!-- Edit form (structure similar to your submission form) -->
            <form id="editForm">
                <label for="editName">Study Spot Name:</label>
                <input type="text" id="editName" name="name" required>

                <label for="editLocation">Location:</label>
                <input type="text" id="editLocation" name="location" required>

                <label for="editWifi">Wi-Fi Available:</label>
                <select id="editWifi" name="wifi">
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>

                <label for="editOutlets">Power Outlets Available:</label>
                <select id="editOutlets" name="outlets">
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>

                <label for="editHours">Opening Hours:</label>
                <input type="text" id="editHours" name="hours">

                <label for="editAdditionalInfo">Additional Information:</label>
                <textarea id="editAdditionalInfo" name="additionalInfo"></textarea>

                <button type="submit">Save Changes</button>
            </form>
            <!-- Close button -->
            <button onclick="closeEditModal()" style="cursor:pointer;">Close/Cancel</button>
        </div>
    </div>

    <footer>
        <p>
            <a href="contact.html">Contact Us</a> | 
            <a href="sitemap.html">Site Map</a> |
            <a href="about.html">About Us</a>
        </p>
    </footer>

    <!-- Script for handling Edit and Approval actions -->
    <script>
        // Placeholder function for approving a spot
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('pendingList').addEventListener('click', function (event) {
                if (event.target.classList.contains('approveBtn')) {
                    const spotId = event.target.getAttribute('data-spot-id');
                    approveSpot(spotId);
                }
            });
        });

        function approveSpot(spotId) {
            // Placeholder: send a request to the server to approve the spot
            console.log('Spot approved:', spotId); // For testing purposes
        }


        function editSpot(spotId) {
            // This will be updated once the database is implemented, for now this is a placeholder spot
            // The logic for updating the database with the edited spot will be added here
            const spotDetails = {
                name: "Quiet Study Cafe",
                location: "Downtown",
                wifi: "yes",
                outlets: "yes",
                hours: "9am - 5pm",
                additionalInfo: "Free coffee for members."
            };

            // Fill the edit form with the spot's details
            document.getElementById('editName').value = spotDetails.name;
            document.getElementById('editLocation').value = spotDetails.location;
            document.getElementById('editWifi').value = spotDetails.wifi;
            document.getElementById('editOutlets').value = spotDetails.outlets;
            document.getElementById('editHours').value = spotDetails.hours;
            document.getElementById('editAdditionalInfo').value = spotDetails.additionalInfo;

            // Show the edit modal
            document.getElementById('editModal').style.display = 'block';
        }

        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
        }

        // Optional: Close the modal if the user clicks outside of it
        window.onclick = function (event) {
            var modal = document.getElementById('editModal');
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        // Add event listener for the edit form submission
        document.getElementById('editForm').addEventListener('submit', function (event) {
            event.preventDefault(); // Prevent the default form submission

            const formData = {
                name: document.getElementById('editName').value,
                location: document.getElementById('editLocation').value,
                wifi: document.getElementById('editWifi').value,
                outlets: document.getElementById('editOutlets').value,
                hours: document.getElementById('editHours').value,
                additionalInfo: document.getElementById('editAdditionalInfo').value,
            };

            // Placeholder: send form data to database here
            console.log(formData); //For testing purposes
            // Reset the form or provide feedback to the user
        });

        // Search query in the search bar
        document.getElementById('search-form').addEventListener('search-btn', function (event) {
            var searchInput = document.getElementById('search-input');
            var errorMessage = document.getElementById('error-message');

            // Check if the search input's value matches the pattern
            if (!searchInput.checkValidity()) {
                event.preventDefault(); // Prevent form submission
                errorMessage.style.display = 'block'; // Show the error message
            } else {
                errorMessage.style.display = 'none'; // Hide the error message

                //Redirect to spot page with fresh query search 

            }
        });


    </script>
</body>

</html>